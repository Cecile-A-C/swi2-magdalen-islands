# swi2-magdalen-islands

MODFLOW-SWI2 model of the Grande-Entrée Island (Magdalen Islands, Quebec, Canada)


Readme.txt

Name of the calibration: calreg_v16_pp_hp

-------------------------
 1) PARAMETER ESTIMATION
-------------------------

PEST was run with the calreg_v16_pp_hp.pst PEST control file and noptmax=10
The best parameter set from this calibration is contained in calreg_v16_pp_hp.par

***The pest_outputs/parameter_estimation folder contains the files generated by PEST-HP (intermediate files are not included)

***The pest_outputs/model_run_priorcalib folder contains the files generated by the script_model_run_plot.py with the prior parameter set (before parameter estimation)

-------------------------
   2) LINEAR ANALYSIS
-------------------------

The PARREP utility was used on calreg_v16_pp_hp.pst, with the best parameter set contained in calreg_v16_pp_hp.par, to create the calreg_v16_pp_hp_la_bpa.pst PEST control file.
In this new control file, no log transformation was implemented on recharge
PEST was run with calreg_v16_pp_hp_la_bpa.pst and noptmax=-1 (to calculate the Jacobian)

***The pest_outputs/linear_analysis_bpa folder contains the files generated by PEST-HP (intermediate files are not included)

***The pest_outputs/model_run_bpa folder contains the files generated by the script_model_run_plot.py with the best parameter set (after parameter estimation)

-------------------------
   FILE DESCRIPTION
-------------------------

***The pest folder contains all the necessary files to conduct parameter estimation:

	***The model_files folder
	[...]
	
	***The model_outputs folder
	[...]
	
	***The pest_files folder
	[...]
	
	*The preproc_IDM_20m_qgis_v6.bin file
	
	*The pp_30max.fac file
	
	*The Python script named script_model_run_pest.py, which uses the functions defined in functions_model_plot.py
	


***The pest_outputs folder contains:

1) The Python script named script_linear_analysis.py

Using the functions defined in functions_linear_analysis.py, it:
- Analyzes residuals
- Conducts linear uncertainty analysis
- Conducts the data worth analysis

And generates figures:
5A and 5B,
7A and 7B,
8A and 8B,
9A and 9B,
A.1


2) The Python script named script_model_run_plot.py:

Using the functions defined in functions_model_plot.py, it:
- Runs the model with the selected parameter set (initial or best)

And generates figures:
6A and 6B


Both these scripts require spatial data, located in the ***gis folder

-------------------------
		REFERENCES
-------------------------


All scripts were developed using examples from:


- The FloPy documentation:

Bakker, Mark, Post, Vincent, Langevin, C. D., Hughes, J. D., White, J. T., Starn, J. J. and Fienen, M. N., 2016, Scripting MODFLOW Model Development Using Python and FloPy: Groundwater, v. 54, p. 733–739, doi:10.1111/gwat.12413.
Bakker, Mark, Post, Vincent, Langevin, C. D., Hughes, J. D., White, J. T., Leaf, A. T., Paulinski, S. R., Larsen, J. D., Toews, M. W., Morway, E. D., Bellino, J. C., Starn, J. J., and Fienen, M. N., 2020, FloPy v3.3.3 — release candidate: U.S. Geological Survey Software Release, 27 October 2020, http://dx.doi.org/10.5066/F7BK19FH

Especially 2 notebooks:
flopy/examples/Notebooks/flopy3_swi2package_ex4.ipynb (http://github.com/modflowpy/flopy/blob/7cb429f81a9206fa450cceff21c695faf01fce41/examples/Notebooks/flopy3_swi2package_ex1.ipynb)
flopy/examples/Notebooks/flopy3_swi2package_ex4.ipynb (http://github.com/modflowpy/flopy/blob/7cb429f81a9206fa450cceff21c695faf01fce41/examples/Notebooks/flopy3_swi2package_ex4.ipynb)


- The PyEMU documentation:

White, J. T., Fienen, M. N., & Doherty, J. E. (2016). A python framework for environmental model uncertainty analysis. Environmental Modelling & Software, 85, 217-228.

Especially 1 notebook:
pyemu/examples/Schurexample_freyberg.ipynb (http://github.com/pypest/pyemu/blob/e6ce853cd8126b984e363186c4cd2c425cae4a1e/examples/Schurexample_freyberg.ipynb)
pyemu/examples/modflow_to_pest_like_a_boss.ipynb (https://github.com/pypest/pyemu/blob/e6ce853cd8126b984e363186c4cd2c425cae4a1e/examples/modflow_to_pest_like_a_boss.ipynb)


- Work from Christopher Shuler, especially 2 notebooks:

CEE-699-Final/Shuler_final/Shuler_CEE696_FINAL_MODEL.ipynb (http://github.com/cshuler/CEE-699-Final/blob/master/Shuler_final/Shuler_CEE696_FINAL_MODEL.ipynb)
ASPA-UH_Integrated_Modeling_Framework/ASPA-UH-Flopy_REPO/Models/Tutuila_SWI_GHB/Tutuila_SWI_GHB_1_MOST_CURRENT.ipynb (https://github.com/cshuler/ASPA-UH_Integrated_Modeling_Framework/blob/master/ASPA-UH-Flopy_REPO/Models/Tutuila_SWI_GHB/Tutuila_SWI_GHB_1_MOST_CURRENT.ipynb)

- Alex = coauteur? Sources à citer?

- Add Doherty references (PEST manual, PEST++ manual)


-------------------------
	ACKNOWLEDGMENTS
-------------------------

Pierre Matran
Ryma Aissat
